---
title: kubernetes资源
date: 2023-02-20 16:07:59
permalink: /pages/80/59/20/
category: 
  - 云原生
  - 云原生
tag: 
  - Kubernetes
---

<!-- more -->

[[toc]]

## Lable

> Label是attach到Pod的一对键/值对，用来传递用户定义的属性。

## POD

```bash
kubectl get pod,deployment,service,secret,configmap,endpoints -A
```

```json
{
    "kind": "Pod",（资源类型）
    "apiVersion": "v1",  （资源版本）
    "metadata": {
        "name": "app-tomcat", （名字，唯一）
        "namespace": "default", (命名空间默认default)
        "labels": {
            "name": "app-tomcat" （label做为标识，可以跟RC，Service关联对应）
        }
    },
    "spec": {
        "containers": [
            {
                "name": "app-tomcat", (自定义镜像名称)
                "image": "tomcat", (要拉取的镜像)
                "command": [   (运行容器时，要运行的命令)
                    "/bin/bash",
                    "/opt/apache-tomcat-7.0.57/bin/catalina.sh",
                    "run"
                ],
                "env": [  （环境变量K,V）
                    {
                        "name": "url_addr",
                        "value": "http://192.168.54.66:8080/paas/jsp/index.jsp"
                    }
                ],
                "resources": { （对容器资源限制）
                    "limits": {
                        "cpu": "1",
                        "memory": "1073741824"
                    },
                    "requests": {
                        "cpu": "100m",
                        "memory": "104857600"
                    }
                },
                "imagePullPolicy": "Always" (获取镜像策略Always,Never,IfNotPresent)
            }
        ],
        "restartPolicy": "Always", (pod重启策略,Always,OnFailure,Never)
        "dnsPolicy": "ClusterFirst",
        "nodeSelector": {  (选择将该pod调度到包含这些label的Node上)
            "group": "node1"
        }
    }
}
```

## Deployment


## Service

> service是pod的路由代理抽象，用于解决pod之间的服务发现问题，即上下游pod之间使用的问题

```json
{
    "kind": "Service",
    "apiVersion": "v1",
    "metadata": {
        "name": "tomcat-yefp",
        "namespace": "default",
        "labels": {
            "name": "tomcat-yefp"
        }
    },
    "spec": {
        "ports": [
            {
                "protocol": "TCP",
                "port": 8080（访问端口）,
                "targetPort": 8080
            }
        ],
        "selector": {
            "name": "app-tomcat（选择的pod的label）"
        },
        "type": "ClusterIP",
        "sessionAffinity": "None"
    }
}
```
